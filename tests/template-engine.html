<!DOCTYPE html>
<html>
<body>
	<div class="view" id="a">
		<div id="${id}">${text} ${bl} ${a['b'].c} ${a["b"].c} ${n[0]} ${m[1]}</div>
	</div>
	<script src="../dist/lib.js"></script>
<script>
function test(label,itr,func){
	console.time(label);
	for(var i=0;i<itr;i++){ func() }
	console.timeEnd(label);
}

function render0(template,data){
	var tpl = template.replace(/\${(?!this\.)/g, "${this.");
	return new Function(`return \`${tpl}\``).call(data);
	// return new Function('return `'+tpl+'`;').call(data);
}

// single level
// var render1es6=(tpl,data)=>tpl.replace(/\${(.*?)}/g,(x,g)=>data[g]);
var render1=function(tpl,data){return tpl.replace(/\${(.*?)}/g,function(x,g){return data[g]})};
// multi level
// var renderes6=(tpl,data)=>tpl.replace(/\${(.*?)}/g,(x,g)=>g.split(/[\.\[\]\'\"]/g).filter(Boolean).reduce((o,i)=>o[i],data));
var render=function(tpl,data){return tpl.replace(/\${(.*?)}/g,function(x,g){
	return g.split(/[\.\[\]\'\"]/g).filter(Boolean).reduce(function(obj,i){return obj[i]},data)
})};

String.prototype.render=function(data){return this.replace(/\${(.*?)}/g,function(x,g){
	return g.split(/[\.\[\]\'\"]/g).filter(Boolean).reduce(function(obj,i){return obj[i]},data)
})};


HTMLElement.prototype._render=function(data){that=this;
	if(!that.template){that.template=that.innerHTML;that.innerHTML=''}
	that.renderHTML='';
	if(Array.isArray(data)){
		data.each(function(item){
			that.renderHTML+=that.template.render(item)
		});
	}
	else{that.renderHTML+=that.template.render(data)}
};
HTMLElement.prototype.render=function(data){this._render(data);
	this.innerHTML=this.renderHTML;
};
HTMLElement.prototype.renderAfter=function(data){this._render(data);
	this.insertAdjacentHTML('beforeend',this.renderHTML);
};
HTMLElement.prototype.renderBefore=function(data){this._render(data);
	this.insertAdjacentHTML('afterbegin',this.renderHTML);
};



// setTimeout(function(){
	var data=[
		{id:143,text:'hello',bl:true,a:{b:{c:'renad'}},n:['a1','b1'],m:{1:'munna'}},
		{id:144,text:'renad munna',bl:false,a:{b:{c:'ali'}},n:['a4','b4'],m:{1:'anni'}}
	];
	
	dom('.view').render(data[1]);
	dom('.view div').on('click',function(e){console.log(e)});
	dom('.view').renderAfter(data);
	dom('.view').renderBefore(data[0]);

	// dom('#a').innerHTML=render(tpl,data)
	// console.log(render(tpl,data));

	// console.time('render');
	// console.log(render(tpl,data));
	// for(var i=0;i<10000;i++){ render(tpl,data) }
	// console.timeEnd('render');

	// console.time('render0');
	// console.log(render0(tpl,data));
	// for(var i=0;i<10000;i++){ render0(tpl,data) }
	// console.timeEnd('render0');

	// console.time('render1');
	// console.log(render1(tpl,data));
	// for(var i=0;i<10000;i++){ render1(tpl,data) }
	// console.timeEnd('render1');

// },0);
</script>

</body>
</html>