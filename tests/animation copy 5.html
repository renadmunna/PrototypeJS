<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0">
	<title>LibJS</title><script src="../src/dev.js"></script>
	<script src="../prototype.js"></script>
<style>
.a,.b{
position:absolute;
left:0;top:0;
width:100px;height:100px;
background-color:tomato;
}
.b{top:100px;}
</style>
</head>
<body>
	<div class="a"></div>
	<div class="b"></div>


<!-- <script src="../src/fps.js"></script> -->
<!-- <script src="../src/anime.min.js"></script> -->
<script>
const easing ={
    // t = Time - Amount of time that has passed since the beginning of the animation. Usually starts at 0 and is slowly increased using a game loop or other update function.
    // b = Beginning value - The starting point of the animation. Usually it's a static value, you can start at 0 for example.
    // c = Change in value - The amount of change needed to go from starting point to end point. It's also usually a static value.
    // d = Duration - Amount of time the animation will take. Usually a static value aswell.
	linear:function(t,b,c,d){return c*t/d+b},
	easeInQuad:function(t,b,c,d){return c*(t/=d)*t+b},
	easeOutQuad:function(t,b,c,d){return -c*(t/=d)*(t-2)+b},
	easeInOutQuad:function(t,b,c,d){return (t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b},
	easeInCubic:function(t,b,c,d){return c*(t/=d)*t*t+b},
	easeOutCubic:function(t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},
	easeInOutCubic:function(t,b,c,d){return (t/=d/2)<1?c/2*t*t*t+b:c/2*((t-=2)*t*t+2)+b},
	easeInQuart:function(t,b,c,d){return c*(t/=d)*t*t*t+b},
	easeOutQuart:function(t,b,c,d){return -c*((t=t/d-1)*t*t*t-1)+b},
	easeInOutQuart:function(t,b,c,d){return (t/=d/2)<1?c/2*t*t*t*t+b:-c/2*((t-=2)*t*t*t-2)+b},
	easeInQuint:function(t,b,c,d){return c*(t/=d)*t*t*t*t+b},
	easeOutQuint:function(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},
	easeInOutQuint:function(t,b,c,d){return (t/=d/2)<1?c/2*t*t*t*t*t+b:c/2*((t-=2)*t*t*t*t+2)+b},
	easeInSine:function(t,b,c,d){return -c*Math.cos(t/d*(Math.PI/2))+c+b},
	easeOutSine:function(t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},
	easeInOutSine:function(t,b,c,d){return -c/2*(Math.cos(Math.PI*t/d)-1)+b},
	easeInExpo:function(t,b,c,d){return t===0?b:c*Math.pow(2,10*(t/d-1))+b},
	easeOutExpo:function(t,b,c,d){return t===d?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},
	easeInOutExpo:function(t,b,c,d){return t===0?b:t===d?b+c:(t/=d/2)<1?c/2*Math.pow(2,10*(t-1))+b:c/2*(-Math.pow(2,-10*--t)+2)+b},
	easeInCirc:function(t,b,c,d){return -c*(Math.sqrt(1-(t/=d)*t)-1)+b},
	easeOutCirc:function(t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},
	easeInOutCirc:function(t,b,c,d){return (t/=d/2)<1?-c/2*(Math.sqrt(1-t*t)-1)+b:c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},
	easeInElastic:function(t,b,c,d){var s=1.70158,p=0,a=c;if(t===0){return b}if((t/=d)===1){return b+c}if(!p){p=d*0.3}if(a<Math.abs(c)){a=c;s=p/4}else{s=p/(2*Math.PI)*Math.asin(c/a)}return -(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b},
	easeOutElastic:function(t,b,c,d){var s=1.70158,p=0,a=c;if(t===0){return b}if((t/=d)===1){return b+c}if(!p){p=d*0.3}if(a<Math.abs(c)){a=c;s=p/4}else{s=p/(2*Math.PI)*Math.asin(c/a)}return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},
	easeInOutElastic:function(t,b,c,d){var s=1.70158,p=0,a=c;if(t===0){return b}if((t/=d/2)===2){return b+c}if(!p){p=d*(0.3*1.5)}if(a<Math.abs(c)){a=c;s=p/4}else{s=p/(2*Math.PI)*Math.asin(c/a)}if(t<1){return -.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b}return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b},
	easeInBack:function(t,b,c,d,s){if(s==undefined){s=1.70158}return c*(t/=d)*t*((s+1)*t-s)+b},
	easeOutBack:function(t,b,c,d,s){if(s==undefined){s=1.70158}return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},
	easeInOutBack(t,b,c,d,s){if(s==undefined){s=1.70158}return (t/=d/2)<1?c/2*(t*t*(((s*=1.525)+1)*t-s))+b:c/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+b},
	easeInBounce:function(t,b,c,d){return c-this.easeOutBounce(d-t,0,c,d)+b},
	easeOutBounce:function(t,b,c,d){if((t/=d)<1/2.75){return c*(7.5625*t*t)+b}else if(t<2/2.75){return c*(7.5625*(t-=1.5/2.75)*t+0.75)+b}else if(t<2.5/2.75){return c*(7.5625*(t-=2.25/2.75)*t+0.9375)+b}else{return c*(7.5625*(t-=2.625/2.75)*t+0.984375)+b}},
	easeInOutBounce:function(t,b,c,d){return t<d/2?this.easeInBounce(t*2,0,c,d)*.5+b:this.easeOutBounce(t*2-d,0,c,d)*.5+c*.5+b}
};
const easingX = {
	// x = the absolute progress of the animation in the bounds of 0 (beginning of the animation) and 1 (end of animation).
	linear:function(x){return x},
	easeInQuad:function(x){return x*x},
	easeOutQuad:function(x){return 1-(1-x)*(1-x)},
	easeInOutQuad:function(x){return x<.5?2*x*x:1-Math.pow(-2*x+2,2)/2},
	easeInCubic:function(x){return x*x*x},
	easeOutCubic:function(x){return 1-Math.pow(1-x,3)},
	easeInOutCubic:function(x){return x<.5?4*x*x*x:1-Math.pow(-2*x+2,3)/2},
	easeInQuart:function(x){return x*x*x*x},
	easeOutQuart:function(x){return 1-Math.pow(1-x,4)},
	easeInOutQuart:function(x){return x<.5?8*x*x*x*x:1-Math.pow(-2*x+2,4)/2},
	easeInQuint:function(x){return x*x*x*x*x},
	easeOutQuint:function(x){return 1-Math.pow(1-x,5)},
	easeInOutQuint:function(x){return x<.5?16*x*x*x*x*x:1-Math.pow(-2*x+2,5)/2},
	easeInSine:function(x){return 1-Math.cos((x*Math.PI)/2)},
	easeOutSine:function(x){return Math.sin((x*Math.PI)/2)},
	easeInOutSine:function(x){return -(Math.cos(Math.PI*x)-1)/2},
	easeInExpo:function(x){return x===0?0:Math.pow(2,10*x-10)},
	easeOutExpo:function(x){return x===1?1:1-Math.pow(2,-10*x)},
	easeInOutExpo:function(x){return x===0?0:x===1?1:x<.5?Math.pow(2,20*x-10)/2:(2-Math.pow(2,-20*x+10))/2},
	easeInCirc:function(x){return 1-Math.sqrt(1-Math.pow(x,2))},
	easeOutCirc:function(x){return Math.sqrt(1-Math.pow(x-1,2))},
	easeInOutCirc:function(x){return x<.5?(1-Math.sqrt(1-Math.pow(2*x,2)))/2:(Math.sqrt(1-Math.pow(-2*x+2,2))+1)/2},
	easeInBack:function(x){return c3*x*x*x-c1*x*x},
	easeOutBack:function(x){return 1+c3*Math.pow(x-1,3)+c1*Math.pow(x-1,2)},
	easeInOutBack:function(x){return x<.5?(Math.pow(2*x,2)*((c2+1)*2*x-c2))/2:(Math.pow(2*x-2,2)*((c2+1)*(x*2-2)+c2)+2)/2},
	easeInElastic:function(x){return x===0?0:x===1?1:-Math.pow(2,10*x-10)*Math.sin((x*10-10.75)*c4)},
	easeOutElastic:function(x){return x===0?0:x===1?1:Math.pow(2,-10*x)*Math.sin((x*10-0.75)*c4)+1},
	easeInOutElastic:function(x){return x===0?0:x===1?1:x<.5?-(Math.pow(2,20*x-10)*Math.sin((20*x-11.125)*c5))/2:(Math.pow(2,-20*x+10)*Math.sin((20*x-11.125)*c5))/2+1},
	easeInBounce:function(x){return 1-this.easeOutBounce(1-x)},
	easeOutBounce:function(x){const n1=7.5625,d1=2.75;return x<1/d1?n1*x*x:x<2/d1?n1*(x-=1.5/d1)*x+0.75:x<2.5/d1?n1*(x-=2.25/d1)*x+0.9375:n1*(x-=2.625/d1)*x+0.984375},
	easeInOutBounce:function(x){return x<.5?(1-this.easeOutBounce(1-2*x))/2:(1+this.easeOutBounce(2*x-1))/2},
};


const fps=function(task){
	task.from=task.range[0];
	task.to=task.range[1];
	if(task.from<task.to){task.range=task.to-task.from;task.vector=1}
	else{task.range=task.from-task.to;task.vector=-1}
	task.start=fps.start;
	task.stop=fps.stop;
	task.process=function(now){
		if(!this.current){this.callback('start');this.current=now}
		const elapsed=now-this.current;
		var progress=elapsed/this.duration;
		result=this.easing&&easing[this.easing]&&easing[this.easing](progress)||easing['linear'](progress);
		// if(task.easing){
		// 	progress=easing[task.easing](progress);
		// }
		// _(easing[this.easing](progress)-easing1[this.easing](progress));
		result=task.range*Math.min(result,1);
		// result=easingFunction[task.easing](run,task.from*task.m,task.range,task.duration);

		// result=task.from+(result*task.m);
		this.update(result);
		// _(elapsed,this.duration,elapsed<this.duration);
		if(elapsed<this.duration){return true;}
		this.callback('stop');
		if(this.done){this.done()}
		return false;
	};
	task.loop=function(now,task){
		task.ref=requestAnimationFrame(task.loop.args(task));
		if(!task.process(now)){task.stop()}
	};
	return task;
};
fps.add=function(){
	arguments.each(function(task){fps.task.push(fps(task))})
	return this;
};
fps.task=[];
fps.loop=function(now,that){
	that.task.each(function(task,index,arr){
		if(!task.process(now)){arr.splice(index,1)}
	});
	if(that.task.length==0 && that.done){that.done()}
	that.ref=requestAnimationFrame(that.loop.args(that));
};
fps.start=function(){this.ref=requestAnimationFrame(this.loop.args(this));return this};
fps.stop=function(){cancelAnimationFrame(this.ref);return this};

fps.timeline=function(){
	arguments.each(function(task){fps.timeline.task.push(fps(task))});
	return this;
};
fps.timeline.task=[];
fps.timeline.loop=fps.loop;
fps.timeline.start=fps.start;
fps.timeline.stop=fps.stop;
fps.timeline.done=function(){this.stop()};


a=$('.a');
b=$('.b');

// ref1=fps({duration:1000,range:[0,150],delay:1000,easing:'linear',
// 	once:function(val){
// 		a.style.transform=`translateX(${val}px)`;
// 	},
// 	callback:function(status){_(status)}
// });
// ref2=fps({duration:2000,range:[0,300],delay:1000,easing:'bounceOut',
// 	once:function(val){
// 		b.style.transform=`translateX(${val}px)`;
// 	},
// 	callback:function(status){_(status)}
// });
// setTimeout(function(){ref2.stop()},1000);
// setTimeout(function(){ref2.play()},2000);

// ref1=fps({duration:1000,range:[0,150],delay:1000,easing:'easeInQuint',
// 	add:function(val){
// 		a.style.transform=`translateX(${val}px)`;
// 	},
// 	callback:function(status){
// 		_(status);
// 		if(!status)
// 		fps.stop();
// 	}
// });
// ref2=fps({duration:2000,range:[300,0],delay:1000,easing:'easeInQuint',
// 	add:function(val){
// 		b.style.transform=`translateX(${val}px)`;
// 	},
// 	callback:function(status){_(status)}
// });

ref1=fps({duration:1000,range:[0,150],delay:1000,easing:'easeOutQuad',
	update:function(val){
		a.style.transform=`translateX(${val}px)`;
	},
	callback:function(status){_(status)},
	done:function(){_('done')}
}).start();
ref2=fps({duration:1000,range:[300,150],delay:1000,easing:'easeOutQuad',
	update:function(val){
		b.style.transform=`translateX(${val}px)`;
	},
	callback:function(status){_(status)},
	done:function(){_('done')}
});

// fps(1000,[0,150]).update(function(val){

// });
// fps(1000,[0,150]).on('update',function(val){

// }).on('done',function(){

// }).;

// fps.add({duration:1000,range:[0,150],delay:1000,easing:'easeInQuint',
// 	update:function(val){
// 		a.style.transform=`translateX(${val}px)`;
// 	},
// 	callback:function(status){_(status)},
//   done:function(){_('done')}
// },{duration:1000,range:[300,150],delay:1000,easing:'easeInQuint',
// 	update:function(val){
// 		b.style.transform=`translateX(${val}px)`;
// 	},
// 	callback:function(status){_(status)},
//   done:function(){_('done')}
// });

// // fps.start();
// // fps.stop();

// fps.timeline({duration:1000,range:[0,150],delay:1000,easing:'easeInQuint',
// 	update:function(val){
// 		a.style.transform=`translateX(${val}px)`;
// 	},
// 	callback:function(status){_(status)},
//   done:function(){_('done')}
// },{duration:1000,range:[300,150],delay:1000,easing:'easeInQuint',
// 	update:function(val){
// 		b.style.transform=`translateX(${val}px)`;
// 	},
// 	callback:function(status){_(status)},
//   done:function(){_('done')}
// });
// // .timeline({duration:3000,range:[300,150],delay:1000,easing:'easeInQuint',
// // 	update:function(val){
// // 		b.style.transform=`translateX(${val}px)`;
// // 	},
// // 	callback:function(status){_(status)},
// //   done:function(){_('done')}
// // });

// // fps.timeline.start();
// // fps.timeline.stop();

// // _(fps.task,fps.timeline.task);

</script>
</body>
</html>