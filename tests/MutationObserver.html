<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>MutationObserver</title><script src="../src/dev.js"></script>
	<script src="../dist/lib.js"></script>
</head>
<body>
<div class="test" db name="score" value=123 >dd</div>
<div class="test" db name="coin" value=1000 >dd</div>
<script></script>
<script>

// document.body.watcher=new MutationObserver(function(mutations,observer){
// 	mutations.forEach(function(mutation){
// 		switch(mutation.type) {
// 			case 'attributes':console.log(mutation);
// 				// console.log(mutation.target, mutation.attributeName, mutation.oldValue, mutation.target.getAttribute(mutation.attributeName));
// 				var obj=mutation.target,
// 					name=mutation.attributeName,
// 					newValue=obj.getAttribute(mutation.attributeName),
// 					oldValue=mutation.oldValue;

// 				obj.dispatchEvent(new CustomEvent('attrChange1',{detail:{
// 					name:name,changes:{new:newValue,old:oldValue}
// 				}}));
// 				obj.dispatchEvent(new CustomEvent('change1',{detail:{
// 					type:'attr',changes:{new:newValue,old:oldValue}
// 				}}));
				
// 			  break;
// 			case 'childList':
// 				// console.log(mutation);
// 				var obj=mutation.target;
// 				if (mutation.addedNodes.length){
// 					obj.dispatchEvent(new CustomEvent('change1',{detail:{
// 						type:'addNode',changes:mutation.addedNodes
// 					}}));
// 				}
// 				if (mutation.removedNodes.length){
// 					obj.dispatchEvent(new CustomEvent('change1',{detail:{
// 						type:'removeNode',changes:mutation.removedNodes
// 					}}));
// 				}
// 			  break;
// 		}
// 	});
// });
// document.body.watcher.observe(document.body,{attributes:true,attributeOldValue:true,childList:true,subtree:true});

DomDB = new MutationObserver(function(mutations,observer){
	mutations.forEach(function(mutation){
		if(mutation.type==='attributes'){
			// console.log(mutation);
			console.log(mutation.target, mutation.attributeName, mutation.oldValue, mutation.target.getAttribute(mutation.attributeName));
		}
	});
});
// DomDB.observe(document.body,{attributes:true,attributeOldValue:true,subtree:true});
DomDB.observe(document.body,{attributes:true,subtree:true});

setTimeout(function(){
	document.querySelector('.test').setAttribute('name','db');
	document.querySelector('.test').setAttribute('name','db123');
	document.querySelector('.test').setAttribute('name','db1545423');
	document.querySelector('.test').setAttribute('value','db1545423');
},2000);

</script>	
</body>
</html>